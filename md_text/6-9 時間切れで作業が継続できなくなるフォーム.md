# 時間切れで作業が継続できなくなるフォーム

ログインして利用するシステムでは、一定時間でセッションが切れてログアウト状態になることが一般的です。しかし、ログアウトまでの時間が短いと、入力に時間のかかるユーザーは入力を完了することができなくなります。

## よく見られる問題

### 短時間でセッションが切れてしまう

短時間でセッションが切れてしまう例。入力に時間がかかったり、少し別のことをしていただけでセッション切れになってしまう。

### セッションが切れると最初からやりなおしになってしまう

セッションが切れると最初からやりなおしになってしまう例。入力に時間がかかると何度でもやりなおしになってしまう。

## ここが問題! 入力に時間のかかるユーザーもいる

入力に時間がかかるユーザーもいます。使い慣れない環境だったり、調べものや他のことをしながら作業しなければならない状況もあります。短時間でセッションが切れると、入力を最後まで終えることができなくなってしまいます。

### 短時間でセッションが切れてしまう

ログインを必要とするシステムの多くは、セッションに有効期限を設け、アクセスがない時間が続くとログアウトするようにしています。サーバーへのアクセスがあれば有効期限は延長されますが、入力中であっても、フォーム画面を開いたまま送信しないでいると、セッションが切れてしまうことがあります。

このとき、ユーザーはログインフォームに戻され、ログインしなおさなければなりません。その際、入力していた内容が失われ、入力しなおしになることもあります。そうなると、入力に時間がかかる状況では、どうやっても送信を完了できなくなってしまいます。

### セッションが切れると最初からやりなおしになってしまう

ログインして行う作業の中には、長いステップを踏むものもあります。セッションが切れた際、ログインしなおすと、トップページに戻されてやりなおしになってしまうケースがあります。セッション切れが頻繁に起こり、かつ最初からやりなおしになると、その作業を完遂できないユーザーも出てきます（図1）。

図1：セッション切れで作業を完遂できないユーザーの例

長いステップの完了間際になると、なぜか必ず子どもが泣き出してしまう。このユーザーは永遠に作業を完了できない。


## 解決アプローチの例

### セッションの有効期限を長くする

セッションの有効期限が長く設定されている例。セッションの有効期限を長くしておけば、途中でセッション切れになる心配は少なくなる。

### 再ログインで続きから作業できるようにする

セッションが切れてしまっても作業内容が保存されており、再ログインすると続きから作業できる例。続きから継続できれば、最終的には入力を完了できる。

## 解決アプローチ セッションは長めに、切れても問題ないように

セッション切れによる中断はユーザーに大きなストレスを与えます。セッション切れがどうしても避けられない場合は、セッションが切れても致命的な問題が起きないようにしましょう。

### セッションの有効期限を長くする

セッションの有効期間が十分に長ければ、作業中にセッションが切れることはありません。WCAG 2.0では「20時間」という基準を採用しています。入力作業に丸一日かけることは現実的ではなく、睡眠時間も考慮すると、20時間以上かけて入力することはないだろうという考えです。

可能であれば、セッションの有効期限を20時間以上に設定しましょう。ミドルウェアやフレームワークのデフォルトで短く設定されていることもありますので、一度設定を確認しておくと良いでしょう。

### 再ログインで続きから作業できるようにする

作業の途中でセッションが切れても、入力していた内容が消えず、引き続き入力できれば被害は少なくなります。入力中の内容を定期的に自動保存しておき、途中から再開できる仕組みにしておくと良いでしょう。長いステップがある場合、きりのいいところで途中経過を保存できるようにすることも有効です（図2）。

図2：入力ステップの途中で保存のタイミングを設けている例

## コラム セッションの有効期限を短くすれば安全になる?

ユーザーが操作中に離席すると他人に操作されてしまうため、短時間で自動ログアウトさせて防ぐべきだという人がいます。しかし、離席直後に操作されれば、やはり問題は起きてしまいます。離席直後でも問題が起きないほど短くすれば、今度は通常の操作でも頻繁にセッションが切れ、誰にも使えなくなってしまうでしょう。

では、セッションの有効期限がどのくらいであれば安全だと言えるのでしょうか?

この問いに明確な答えを出すことは難しいでしょう。セッションを短くすることのセキュリティ的な意味は限定的で、効果はそれほど明確ではありません。結局のところ、ログイン中に離席すること自体に問題があると言わざるを得なくなってきます。操作中に離席しないこと、共有端末では確実にログアウト操作をすることが重要です。自動ログアウトで安全性を確保するより、そういった点をアナウンスして、ユーザーの注意喚起を促すほうが望ましいでしょう。
